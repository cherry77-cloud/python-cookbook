from collections import deque
from typing import Iterable, Generator, List, Tuple

"""
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 1.1 å°†åºåˆ—åˆ†è§£ä¸ºå•ç‹¬å˜é‡ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â­ é€‚ç”¨å¯¹è±¡ : æ‰€æœ‰å¯è¿­ä»£å¯¹è±¡ (å…ƒç»„ / åˆ—è¡¨ / å­—ç¬¦ä¸² / æ–‡ä»¶å¯¹è±¡ / è¿­ä»£å™¨ / ç”Ÿæˆå™¨ â€¦)
â­ æ•°é‡åŒ¹é… : å˜é‡æ•°é‡å¿…é¡»ä¸Žåºåˆ—å…ƒç´ æ•°é‡ä¸€è‡´ï¼Œå¦åˆ™æŠ› ValueError
â­ ç»“æž„åŒ¹é… : æ”¯æŒåµŒå¥—ç»“æž„è§£åŒ…ï¼Œä¾‹å¦‚ (year, mon, day) = date_tuple
â­ å ä½ç¬¦   : ä½¿ç”¨ä¸‹åˆ’çº¿ _ å¿½ç•¥ä¸éœ€è¦çš„å€¼
â­ éƒ¨åˆ†è§£åŒ… : Python æ— ä¸“é—¨è¯­æ³•ï¼Œå¿…é¡»ä¸ºæ¯ä¸ªå…ƒç´ æä¾›å˜é‡å (æˆ–å ä½ç¬¦)
â™»ï¸ å¯è¿­ä»£åˆ¤å®š : å¯¹è±¡åªéœ€å®žçŽ° __iter__() å³è§†ä½œ Iterable
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ä¸‡ç‰©çš†å¯¹è±¡  Everything is an Object (identity / type / value)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ðŸ”¥ðŸ”¥ðŸ”¥ Python è¿è¡ŒæœŸæŠŠä»»ä½•ä¸œè¥¿ï¼ˆæ•°å­—ã€å­—ç¬¦ä¸²ã€å‡½æ•°ã€ç±»ã€æ¨¡å—ã€None â€¦ï¼‰éƒ½è§†ä½œ object çš„ä¸€ä¸ªå®žä¾‹ã€‚
æ¯ä¸ªå¯¹è±¡è‡ªå¸¦ä¸‰å—æ ¸å¿ƒå…ƒä¿¡æ¯
â­ identity  â€” id(obj) è¿”å›žçš„æ•´æ•°ï¼Œé€šå¸¸æ˜ å°„åˆ°å¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼›åœ¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ã€‚
â­ type â€” type(obj) è¿”å›žå¯¹è±¡æ‰€å±žçš„ classï¼Œå†³å®šå®ƒæ”¯æŒå“ªäº›æ“ä½œã€æ–¹æ³•ä¸Žè¿ç®—ç¬¦ã€‚
â­ value  â€” å¯¹è±¡å­˜å‚¨çš„æ•°æ®æœ¬ä½“ã€‚
   - ä¸å¯å˜å¯¹è±¡ (int, str, tuple, frozenset â€¦) ä¸€æ—¦åˆ›å»ºå…¶å€¼ä¸å¯ä¿®æ”¹ï¼›â€œä¿®æ”¹â€ ä¼šå¾—åˆ°æ–°å¯¹è±¡ï¼Œèº«ä»½æ”¹å˜ã€‚
   - å¯å˜å¯¹è±¡ (list, dict, set, bytearray â€¦) å¯åœ¨åŽŸèº«ä»½ä¸ŠåŽŸåœ°ä¿®æ”¹å…¶å€¼
"""

# åŸºæœ¬è§£åŒ…
x, y = (4, 5)
# åˆ—è¡¨ + åµŒå¥—å…ƒç»„
data = ['ACME', 50, 91.1, (2012, 12, 21)]
name, shares, price, (year, mon, day) = data  # åµŒå¥—è§£åŒ…
# ä½¿ç”¨å ä½ç¬¦ _ å¿½ç•¥ä¸éœ€è¦çš„å€¼
_, shares, price, _ = data
# âŒ è§£åŒ…æ•°é‡ä¸åŒ¹é…ç¤ºä¾‹ (æŠ› ValueError)
try:
    a, b, c = (1, 2)
except ValueError as err:
    print("ValueError:", err)


"""
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 1.2 è§£åŽ‹å¯è¿­ä»£å¯¹è±¡èµ‹å€¼ç»™å¤šä¸ªå˜é‡ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â­ é€‚ç”¨åœºæ™¯ : å½“å¯è¿­ä»£å¯¹è±¡å…ƒç´ å¤šäºŽå˜é‡æ—¶ï¼Œç”¨ *var æŽ¥æ”¶å‰©ä½™å…ƒç´ 
â­ æ”¶é›†ç±»åž‹ : *var æ°¸è¿œæ˜¯ listï¼ˆå³ä¾¿ä¸ºç©ºï¼‰
â­ ä½ç½®çµæ´» : *var å¯åœ¨å¼€å¤´ã€ä¸­é—´ã€ç»“å°¾ï¼ˆ*head, last / first, *mid, last / first, *tailï¼‰
â­ å ä½ç¬¦   : è‹¥ä»…æƒ³ä¸¢å¼ƒä½™ä¸‹å…ƒç´ ï¼Œç”¨ *_ æˆ–å…¶ä»–å ä½å
"""

def drop_first_last(grades):                     # grades = [10, 9, 8, 7, 6]
    first, *middle, last = grades
    return sum(middle) / len(middle)             # â†’ 8.0

record = ('Dave', 'dave@example.com', '773-555-1212', '847-555-1212')
name, email, *phones = record  # name='Dave', email='dave@example.com', phones=['773-555-1212','847-555-1212']
line = 'nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false'
uname, *_, homedir, shell = line.split(':')       # uname='nobody', homedir='/var/empty', shell='/usr/bin/false'


"""
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 1.3 ä¿ç•™æœ€åŽ N ä¸ªå…ƒç´  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â­ é—®é¢˜     : è¿­ä»£æˆ–å…¶ä»–æ“ä½œä¸­ï¼Œä»…éœ€ä¿ç•™æœ€è¿‘ N æ¡è®°å½•
â­ è§£å†³æ–¹æ¡ˆ : ä½¿ç”¨ collections.deque(maxlen=N) è‡ªåŠ¨ä¸¢å¼ƒæœ€è€å…ƒç´ 
â­ ç‰¹ç‚¹     : append æ“ä½œ O(1)ï¼Œæ»¡æ—¶è‡ªåŠ¨å‰”é™¤é˜Ÿé¦–ï¼›appendleft, pop, popleft åŒæ ·é«˜æ•ˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â­ å®¹å™¨ (Container)
   â€¢ å®šä¹‰ : å®žçŽ° __contains__(self, item) æˆ–æ”¯æŒ in è¿ç®—çš„å¯¹è±¡ï¼Œå¯å­˜æ”¾å…¶ä»–å¯¹è±¡çš„ç›’å­
   â€¢ å…¸åž‹ : list, tuple, set, dict, str, deque, è‡ªå®šä¹‰ç±»å®žçŽ° __iter__/__len__/__contains__ äº¦å¯è§†ä¸ºå®¹å™¨
   â€¢ ç‰¹æ€§ : å¯é…åˆ len(), in, è¿­ä»£ç­‰æ“ä½œ; å¤šæ•°å®¹å™¨åŒæ ·æ˜¯ Iterable / Collection
â­ ç”Ÿæˆå™¨ (Generator)
   â€¢ å®šä¹‰ : å«æœ‰ yield çš„å‡½æ•°è°ƒç”¨ç»“æžœï¼Œè¿”å›žä¸€ä¸ªå»¶è¿Ÿè®¡ç®—çš„è¿­ä»£å™¨ï¼›æˆ– (expr for x in iterable) æŽ¨å¯¼å¼äº§ç”Ÿ
   â€¢ åè®® : åŒæ—¶å®žçŽ° __iter__() å’Œ __next__()ï¼Œæ¯æ¬¡ next() äº§å‡ºä¸€ä¸ªå€¼ï¼Œç›´è‡³æŠ› StopIteration
   â€¢ ä¼˜åŠ¿ : æƒ°æ€§ã€èŠ‚çœå†…å­˜ï¼Œå¯æ— é™åºåˆ—æˆ–å¤§æ•°æ®æµ; å¯é…åˆ send() /throw() /close() åšåç¨‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"""
def search(lines: Iterable[str], pattern: str, history: int = 3) -> Generator[Tuple[str, List[str]], None, None]:
    prev: deque[str] = deque(maxlen=history)
    for line in lines:
        if pattern in line:
            yield line, list(prev)
        prev.append(line)

logs = ['a','python error','b','c','python ok','d']
for match, prev in search(logs, 'python', history=2):
    print(match, prev)                          # â†’ 'python error', ['a']
                                                # â†’ 'python ok', ['b', 'c']
